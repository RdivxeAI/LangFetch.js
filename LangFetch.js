/*!
 * LangFetch.js Library
 * Natural Language HTTP/JSON/FormData Requests
 * Author: Amr Twig
 * Company: Rdivxe LLC
 * Description: A developer-friendly JS library for sending GET, POST, JSON, FormData, and file requests using highly flexible natural language prompts in Arabic or English. Supports synonyms, conversational context filtering, automatic type conversion, file uploads, and repeated requests.
 */
document.querySelectorAll("prompt").forEach(e=>e.style.display="none");const LangFetch={values:{},definePlaceholder(t,a="string"){if(!this.values[t]){let e;switch(a.toLowerCase()){case"object":case"array":e={};break;case"number":e=0;break;case"boolean":e=!1;break;default:e=""}this.values[t]=e,window.hasOwnProperty(t)||Object.defineProperty(window,t,{get:()=>this.values[t],set:e=>{this.values[t]=e}})}},parsePrompt(e){if(!(t=e.match(/(?:في\s*(?:المتغير|variable|الناتج|result)\s*|خزن\s*في\s*|store\s*in\s*)([a-zA-Z0-9_]+)(?:\s*(?:من\s*النوع|of\s*type)\s+([a-zA-Z0-9_]+))?/i)))return null;var t,a=t[1];if(this.definePlaceholder(a,t=t[2]||"string"),!(r=e.match(/https?:\/\/[^\s]+/)))return null;var r=r[0],s=/(ابعت|send|ارسل|post|بعت|رفع)/i.test(e)?"POST":"GET";let o=null,n=e.match(/(?:params|بيانات|جسم\s*الطلب|body)\s*[:=]\s*(\{.*\})/i);if(n)try{o=JSON.parse(n[1])}catch(e){o=null}return(n=e.match(/(?:ارفع|upload|file)\s+([a-zA-Z0-9_]+)/i))&&this.values[n[1]]instanceof File&&(o=o||new FormData).append(n[1],this.values[n[1]]),{varName:a,type:t,url:r,method:s,body:o}},async run(a){if(!(a=this.parsePrompt(a)))return null;var r={method:a.method};"POST"===a.method&&a.body&&(a.body instanceof FormData||"object"!=typeof a.body?r.body=a.body:(r.body=JSON.stringify(a.body),r.headers={"Content-Type":"application/json"}));try{let e=await(await fetch(a.url,r)).text(),t;try{switch(a.type.toLowerCase()){case"object":case"array":t=JSON.parse(e);break;case"number":t=Number(e);break;case"boolean":t="true"===e.trim().toLowerCase();break;default:t=e}}catch(r){t=e}return window[a.varName]=t}catch(r){return console.error("LangFetch Error:",r),window[a.varName]=null}},runAllPrompts(){document.querySelectorAll("prompt").forEach(e=>this.run(e.textContent))},async repeat(t,a=1){var r=[];for(let e=0;e<a;e++)r.push(await this.run(t));return r}};LangFetch.runAllPrompts(),window.pro=e=>LangFetch.run(e),window.proRepeat=(e,t=1)=>LangFetch.repeat(e,t);
