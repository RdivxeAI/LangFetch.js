/*!
 * LangFetch.js Library
 * Natural Language HTTP/JSON/FormData Requests
 * Author: Amr Twig
 * Company: Rdivxe LLC
 * Description: A developer-friendly JS library for sending GET, POST, JSON, FormData, and file requests using natural language prompts in Arabic or English. Supports placeholders, automatic type conversion, file uploads, dynamic parameters, and repeated requests.
 */
!function(){const t=[],o=e=>{"function"==typeof window.pro?window.pro(e):t.push(e)};document.querySelectorAll("prompt").forEach(e=>o(e.textContent)),new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{1===e.nodeType&&(e.tagName&&"prompt"===e.tagName.toLowerCase()?o(e.textContent):e.querySelectorAll&&e.querySelectorAll("prompt").forEach(e=>o(e.textContent)))})})}).observe(document.documentElement||document.body,{childList:!0,subtree:!0});const e=()=>{if("function"==typeof window.pro)for(;t.length;)window.pro(t.shift());else setTimeout(e,100)};e()}(),document.querySelectorAll("prompt").forEach(e=>e.style.display="none");const LangFetch={values:{},definePlaceholder(t,o="string"){if(!this.values[t]){let e;switch(o.toLowerCase()){case"object":case"array":e={};break;case"number":e=0;break;case"boolean":e=!1;break;default:e=""}this.values[t]=e,window.hasOwnProperty(t)||Object.defineProperty(window,t,{get:()=>this.values[t],set:e=>{this.values[t]=e}})}},parsePrompt(e){var t = e.match(/(?:في\s*(?:المتغير)\s+|in\s*variable\s+)([a-zA-Z0-9_]+)(?:\s*(?:من النوع|of type)\s+([a-zA-Z0-9_]+))?/i);if(!t)return null;var o=t[1],t=t[2]||"string",r=(this.definePlaceholder(o,t),e.match(/https?:\/\/[^\s]+/));if(!r)return null;let a=r[0],n=/(ابعت|send)/i.test(e)?"POST":"GET",s=null,c=e.match(/params\s*[:=]\s*(\{.*\})/i);if(c)try{s=JSON.parse(c[1])}catch(e){s=null}r=e.match(/(?:ارفع|upload)\s+([a-zA-Z0-9_]+)/i);return r&&this.values[r[1]]instanceof File&&(s=s||new FormData).append(r[1],this.values[r[1]]),{varName:o,type:t,url:a,method:n,body:s}},async run(r){if(!(r=this.parsePrompt(r)))return null;var e={method:r.method};"POST"===r.method&&r.body&&(r.body instanceof FormData||"object"!=typeof r.body?e.body=r.body:(e.body=JSON.stringify(r.body),e.headers={"Content-Type":"application/json"}));try{let t=await(await fetch(r.url,e)).text(),o;try{switch(r.type.toLowerCase()){case"object":case"array":o=JSON.parse(t);break;case"number":o=Number(t);break;case"boolean":o="true"===t.trim().toLowerCase();break;default:o=t}}catch(e){o=t}return window[r.varName]=o}catch(e){return console.error("LangFetch Error:",e),window[r.varName]=null}},runAllPrompts(){document.querySelectorAll("prompt").forEach(e=>this.run(e.textContent))},async repeat(t,o=1){var r=[];for(let e=0;e<o;e++)r.push(await this.run(t));return r}};!function(){const t=[],o=e=>{"function"==typeof window.pro?window.pro(e):t.push(e)};LangFetch.runAllPrompts(),new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{1===e.nodeType&&(e.tagName&&"prompt"===e.tagName.toLowerCase()?o(e.textContent):e.querySelectorAll&&e.querySelectorAll("prompt").forEach(e=>o(e.textContent)))})})}).observe(document.documentElement||document.body,{childList:!0,subtree:!0});const e=()=>{if("function"==typeof window.pro)for(;t.length;)window.pro(t.shift());else setTimeout(e,100)};e()}(),window.pro=e=>LangFetch.run(e),window.proRepeat=(e,t=1)=>LangFetch.repeat(e,t);
