/*!
 * LangFetch.js Library (Patched)
 * Natural Language HTTP/JSON/FormData Requests
 * Author: Amr Twig
 * Company: Rdivxe LLC
 * Description: Enhanced to auto-run new <prompt> elements even if added after load.
 */
document.querySelectorAll("prompt").forEach(e=>e.style.display="none");const LangFetch={values:{},definePlaceholder(t,r="string"){if(!this.values[t]){let e;switch(r.toLowerCase()){case"object":case"array":e={};break;case"number":e=0;break;case"boolean":e=!1;break;default:e=""}this.values[t]=e,window.hasOwnProperty(t)||Object.defineProperty(window,t,{get:()=>this.values[t],set:e=>{this.values[t]=e}})}},parsePrompt(e){var t=e.match(/في\s*(?:المتغير|variable)\s+([a-zA-Z0-9_]+)(?:\s+من النوع\s+([a-zA-Z0-9_]+))?/i);if(!t)return null;var r=t[1],t=t[2]||"string",a=(this.definePlaceholder(r,t),e.match(/https?:\/\/[^\s]+/));if(!a)return null;let o=a[0],n=/(ابعت|send)/i.test(e)?"POST":"GET",s=null,l=e.match(/params\s*[:=]\s*(\{.*\})/i);if(l)try{s=JSON.parse(l[1])}catch(e){s=null}a=e.match(/(?:ارفع|upload)\s+([a-zA-Z0-9_]+)/i);return a&&this.values[a[1]]instanceof File&&(s=s||new FormData).append(a[1],this.values[a[1]]),{varName:r,type:t,url:o,method:n,body:s}},async run(a){if(!(a=this.parsePrompt(a)))return null;var e={method:a.method};"POST"===a.method&&a.body&&(a.body instanceof FormData||"object"!=typeof a.body?e.body=a.body:(e.body=JSON.stringify(a.body),e.headers={"Content-Type":"application/json"}));try{let t=await(await fetch(a.url,e)).text(),r;try{switch(a.type.toLowerCase()){case"object":case"array":r=JSON.parse(t);break;case"number":r=Number(t);break;case"boolean":r="true"===t.trim().toLowerCase();break;default:r=t}}catch(e){r=t}return window[a.varName]=r}catch(e){return console.error("LangFetch Error:",e),window[a.varName]=null}},runAllPrompts(){document.querySelectorAll("prompt").forEach(e=>this.run(e.textContent))},async repeat(t,r=1){var a=[];for(let e=0;e<r;e++)a.push(await this.run(t));return a}};!function(){const t=[],r=e=>{"function"==typeof window.pro?window.pro(e):t.push(e)};LangFetch.runAllPrompts(),new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{1===e.nodeType&&(e.tagName&&"prompt"===e.tagName.toLowerCase()?r(e.textContent):e.querySelectorAll&&e.querySelectorAll("prompt").forEach(e=>r(e.textContent)))})})}).observe(document.documentElement||document.body,{childList:!0,subtree:!0});const e=()=>{if("function"==typeof window.pro)for(;t.length;)window.pro(t.shift());else setTimeout(e,100)};e()}(),window.pro=e=>LangFetch.run(e),window.proRepeat=(e,t=1)=>LangFetch.repeat(e,t);
